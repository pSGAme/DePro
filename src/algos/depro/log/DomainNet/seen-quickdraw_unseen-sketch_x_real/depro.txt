================Parameters Settings=================
Parameters:	Namespace(vptNumTokens=4, text='DCoOp', textNumTokens=1, VL_independent=True, generator_layer=2, domain_specific_trick=False, decouple=True, triplet=False, ln_trick=False, log_name='depro', disable_first_pre_ln=False, second_init='xavier', first_init='xavier', optimizer='adam', l2_reg=0.0, epochs=1, lr=0.0001, momentum=0.9, resume_dict=None, code_path='/home/user/Code/DePro_SIGIR', dataset_path='/data/UCDR/data', dataset='DomainNet', is_eccv_split=1, clip_backbone='ViT-B/32', CLS_NUM_TOKENS=300, DOM_NUM_TOKENS=5, debug_mode=0, dropout=0.5, seen_domain='quickdraw', holdout_domain='sketch', gallery_domain='real', include_auxillary_domains=1, udcdr=0, image_size=224, seed=0, batch_size=60, num_workers=6, early_stop=2, log_interval=100)
================Training Settings=================
lr = 0.0001
batch_size = 60
================Baseline Settings=================
visual UDP numbers = 4
text prompt-setup = DCoOp
text UDP numbers= 1
UDPs independent? = True
use triplet loss? = False
generator_layer_num = 2
==================================================
======== Training Parameters ========
text_prompt_learner.ctx
text_encoder.text_projection
visual_udp_generator.prompt_embeddings
visual_encoder.class_embedding
visual_encoder.proj
visual_encoder.prompt_embeddings
visual_encoder.meta_net.proj
visual_encoder.meta_net.specific_domain_prompts
visual_encoder.meta_net.specific_class_prompts
visual_encoder.meta_net.vit.class_embedding
visual_encoder.meta_net.vit.positional_embedding
visual_encoder.meta_net.vit.proj
visual_encoder.meta_net.vit.conv1.weight
visual_encoder.meta_net.vit.ln_pre.weight
visual_encoder.meta_net.vit.ln_pre.bias
visual_encoder.meta_net.vit.transformer.resblocks.0.attn.in_proj_weight
visual_encoder.meta_net.vit.transformer.resblocks.0.attn.in_proj_bias
visual_encoder.meta_net.vit.transformer.resblocks.0.attn.out_proj.weight
visual_encoder.meta_net.vit.transformer.resblocks.0.attn.out_proj.bias
visual_encoder.meta_net.vit.transformer.resblocks.0.ln_1.weight
visual_encoder.meta_net.vit.transformer.resblocks.0.ln_1.bias
visual_encoder.meta_net.vit.transformer.resblocks.0.mlp.c_fc.weight
visual_encoder.meta_net.vit.transformer.resblocks.0.mlp.c_fc.bias
visual_encoder.meta_net.vit.transformer.resblocks.0.mlp.c_proj.weight
visual_encoder.meta_net.vit.transformer.resblocks.0.mlp.c_proj.bias
visual_encoder.meta_net.vit.transformer.resblocks.0.ln_2.weight
visual_encoder.meta_net.vit.transformer.resblocks.0.ln_2.bias
visual_encoder.meta_net.vit.transformer.resblocks.1.attn.in_proj_weight
visual_encoder.meta_net.vit.transformer.resblocks.1.attn.in_proj_bias
visual_encoder.meta_net.vit.transformer.resblocks.1.attn.out_proj.weight
visual_encoder.meta_net.vit.transformer.resblocks.1.attn.out_proj.bias
visual_encoder.meta_net.vit.transformer.resblocks.1.ln_1.weight
visual_encoder.meta_net.vit.transformer.resblocks.1.ln_1.bias
visual_encoder.meta_net.vit.transformer.resblocks.1.mlp.c_fc.weight
visual_encoder.meta_net.vit.transformer.resblocks.1.mlp.c_fc.bias
visual_encoder.meta_net.vit.transformer.resblocks.1.mlp.c_proj.weight
visual_encoder.meta_net.vit.transformer.resblocks.1.mlp.c_proj.bias
visual_encoder.meta_net.vit.transformer.resblocks.1.ln_2.weight
visual_encoder.meta_net.vit.transformer.resblocks.1.ln_2.bias
visual_encoder.meta_net.vit.ln_post.weight
visual_encoder.meta_net.vit.ln_post.bias
tot=143781632, train = 18457344
===============================================
[Train] Epoch: [1/1][100/3536]  Time 0.384 (0.398)  cls 5.8256 (7.3770)  triplet 0.1402 (0.1741)  mse 0.0007 (0.0010)  tot 5.8256 (7.3770)  
[Train] Epoch: [1/1][200/3536]  Time 0.383 (0.390)  cls 6.1621 (6.6441)  triplet 0.1881 (0.1720)  mse 0.0006 (0.0009)  tot 6.1621 (6.6441)  
[Train] Epoch: [1/1][300/3536]  Time 0.384 (0.388)  cls 5.4267 (6.2996)  triplet 0.1908 (0.1785)  mse 0.0006 (0.0008)  tot 5.4267 (6.2996)  
[Train] Epoch: [1/1][400/3536]  Time 0.383 (0.387)  cls 5.6443 (6.1012)  triplet 0.2516 (0.1803)  mse 0.0006 (0.0007)  tot 5.6443 (6.1012)  
[Train] Epoch: [1/1][500/3536]  Time 0.385 (0.386)  cls 5.1198 (5.9604)  triplet 0.0603 (0.1753)  mse 0.0006 (0.0007)  tot 5.1198 (5.9604)  
[Train] Epoch: [1/1][600/3536]  Time 0.385 (0.386)  cls 5.0692 (5.8563)  triplet 0.1149 (0.1764)  mse 0.0005 (0.0007)  tot 5.0692 (5.8563)  
[Train] Epoch: [1/1][700/3536]  Time 0.384 (0.385)  cls 4.7369 (5.7651)  triplet 0.2256 (0.1769)  mse 0.0005 (0.0007)  tot 4.7369 (5.7651)  
[Train] Epoch: [1/1][800/3536]  Time 0.384 (0.385)  cls 5.6634 (5.6913)  triplet 0.1254 (0.1746)  mse 0.0006 (0.0006)  tot 5.6634 (5.6913)  
[Train] Epoch: [1/1][900/3536]  Time 0.382 (0.385)  cls 5.0308 (5.6178)  triplet 0.1777 (0.1739)  mse 0.0006 (0.0006)  tot 5.0308 (5.6178)  
[Train] Epoch: [1/1][1000/3536]  Time 0.384 (0.385)  cls 5.5442 (5.5604)  triplet 0.2353 (0.1742)  mse 0.0005 (0.0006)  tot 5.5442 (5.5604)  
[Train] Epoch: [1/1][1100/3536]  Time 0.384 (0.385)  cls 4.8256 (5.5068)  triplet 0.1145 (0.1735)  mse 0.0006 (0.0006)  tot 4.8256 (5.5068)  
[Train] Epoch: [1/1][1200/3536]  Time 0.383 (0.385)  cls 5.3233 (5.4639)  triplet 0.2467 (0.1744)  mse 0.0005 (0.0006)  tot 5.3233 (5.4639)  
[Train] Epoch: [1/1][1300/3536]  Time 0.383 (0.385)  cls 6.1756 (5.4279)  triplet 0.2225 (0.1744)  mse 0.0005 (0.0006)  tot 6.1756 (5.4279)  
[Train] Epoch: [1/1][1400/3536]  Time 0.385 (0.385)  cls 4.6825 (5.3897)  triplet 0.1681 (0.1732)  mse 0.0005 (0.0006)  tot 4.6825 (5.3897)  
[Train] Epoch: [1/1][1500/3536]  Time 0.386 (0.385)  cls 5.1903 (5.3550)  triplet 0.1806 (0.1737)  mse 0.0005 (0.0006)  tot 5.1903 (5.3550)  
[Train] Epoch: [1/1][1600/3536]  Time 0.385 (0.385)  cls 4.5362 (5.3205)  triplet 0.3764 (0.1737)  mse 0.0005 (0.0006)  tot 4.5362 (5.3205)  
[Train] Epoch: [1/1][1700/3536]  Time 0.384 (0.385)  cls 4.9241 (5.2930)  triplet 0.0292 (0.1722)  mse 0.0005 (0.0006)  tot 4.9241 (5.2930)  
[Train] Epoch: [1/1][1800/3536]  Time 0.384 (0.384)  cls 4.0449 (5.2631)  triplet 0.2124 (0.1715)  mse 0.0004 (0.0006)  tot 4.0449 (5.2631)  
[Train] Epoch: [1/1][1900/3536]  Time 0.385 (0.384)  cls 4.3231 (5.2360)  triplet 0.0726 (0.1718)  mse 0.0004 (0.0006)  tot 4.3231 (5.2360)  
[Train] Epoch: [1/1][2000/3536]  Time 0.387 (0.385)  cls 4.6514 (5.2153)  triplet 0.1617 (0.1715)  mse 0.0004 (0.0006)  tot 4.6514 (5.2153)  
[Train] Epoch: [1/1][2100/3536]  Time 0.386 (0.385)  cls 4.8107 (5.1922)  triplet 0.1748 (0.1715)  mse 0.0004 (0.0005)  tot 4.8107 (5.1922)  
[Train] Epoch: [1/1][2200/3536]  Time 0.384 (0.385)  cls 5.0835 (5.1706)  triplet 0.2123 (0.1720)  mse 0.0005 (0.0005)  tot 5.0835 (5.1706)  
[Train] Epoch: [1/1][2300/3536]  Time 0.383 (0.385)  cls 4.6055 (5.1530)  triplet 0.0681 (0.1712)  mse 0.0005 (0.0005)  tot 4.6055 (5.1530)  
[Train] Epoch: [1/1][2400/3536]  Time 0.383 (0.385)  cls 5.0809 (5.1339)  triplet 0.4248 (0.1717)  mse 0.0005 (0.0005)  tot 5.0809 (5.1339)  
[Train] Epoch: [1/1][2500/3536]  Time 0.385 (0.385)  cls 5.0051 (5.1148)  triplet 0.0344 (0.1709)  mse 0.0004 (0.0005)  tot 5.0051 (5.1148)  
[Train] Epoch: [1/1][2600/3536]  Time 0.382 (0.385)  cls 4.2863 (5.0983)  triplet 0.1944 (0.1708)  mse 0.0004 (0.0005)  tot 4.2863 (5.0983)  
[Train] Epoch: [1/1][2700/3536]  Time 0.385 (0.385)  cls 3.7159 (5.0791)  triplet 0.0395 (0.1700)  mse 0.0004 (0.0005)  tot 3.7159 (5.0791)  
[Train] Epoch: [1/1][2800/3536]  Time 0.384 (0.385)  cls 4.3178 (5.0661)  triplet 0.0302 (0.1700)  mse 0.0005 (0.0005)  tot 4.3178 (5.0661)  
[Train] Epoch: [1/1][2900/3536]  Time 0.383 (0.385)  cls 4.3284 (5.0503)  triplet 0.2376 (0.1698)  mse 0.0005 (0.0005)  tot 4.3284 (5.0503)  
[Train] Epoch: [1/1][3000/3536]  Time 0.381 (0.384)  cls 4.2709 (5.0369)  triplet 0.2160 (0.1695)  mse 0.0004 (0.0005)  tot 4.2709 (5.0369)  
[Train] Epoch: [1/1][3100/3536]  Time 0.383 (0.384)  cls 3.8598 (5.0234)  triplet 0.0510 (0.1691)  mse 0.0004 (0.0005)  tot 3.8598 (5.0234)  
[Train] Epoch: [1/1][3200/3536]  Time 0.384 (0.384)  cls 5.2863 (5.0114)  triplet 0.0447 (0.1690)  mse 0.0005 (0.0005)  tot 5.2863 (5.0114)  
[Train] Epoch: [1/1][3300/3536]  Time 0.385 (0.384)  cls 4.6033 (4.9977)  triplet 0.2232 (0.1691)  mse 0.0004 (0.0005)  tot 4.6033 (4.9977)  
[Train] Epoch: [1/1][3400/3536]  Time 0.383 (0.384)  cls 4.7394 (4.9867)  triplet 0.3574 (0.1691)  mse 0.0004 (0.0005)  tot 4.7394 (4.9867)  
[Train] Epoch: [1/1][3500/3536]  Time 0.384 (0.384)  cls 4.6256 (4.9719)  triplet 0.2489 (0.1688)  mse 0.0004 (0.0005)  tot 4.6256 (4.9719)  
epoch = [1/1]loss = {'net': 4.968482657053352, 'acc': 0.5616751508295625}

***Validation***
udcdr == 0
Query:sketch; Gallery:real; Generalized:0

Query Emb Dim:torch.Size([9729, 512]); Gallery Emb Dim:torch.Size([24387, 512])
computing unormed situation
tensor(0.6096, device='cuda:1') tensor(0.5554, device='cuda:1')
tensor(0.6022, device='cuda:1') tensor(0.5577, device='cuda:1')
tensor(0.6114, device='cuda:1') tensor(0.5642, device='cuda:1')
computing normed situation
tensor(0.6444, device='cuda:1') tensor(0.6012, device='cuda:1')
tensor(0.6544, device='cuda:1') tensor(0.6162, device='cuda:1')
tensor(0.6554, device='cuda:1') tensor(0.6154, device='cuda:1')
un-norm situation:
learned: map: 0.6096087098121643, prec: 0.5554265975952148
11fixed: map: 0.6021682620048523, prec: 0.5577418208122253
combine: map: 0.6113508343696594, prec: 0.5642358064651489
norm situation:
learned: map: 0.6443758010864258, prec: 0.6011506915092468
11fixed: map: 0.6544016003608704, prec: 0.6161660552024841
combine: map: 0.6553784012794495, prec: 0.615378737449646
Query:sketch; Gallery:real; Generalized:1

Query Emb Dim:torch.Size([9729, 512]); Gallery Emb Dim:torch.Size([36600, 512])
computing unormed situation
tensor(0.5580, device='cuda:1') tensor(0.5100, device='cuda:1')
tensor(0.5488, device='cuda:1') tensor(0.5072, device='cuda:1')
tensor(0.5586, device='cuda:1') tensor(0.5157, device='cuda:1')
computing normed situation
tensor(0.5678, device='cuda:1') tensor(0.5331, device='cuda:1')
tensor(0.5766, device='cuda:1') tensor(0.5472, device='cuda:1')
tensor(0.5776, device='cuda:1') tensor(0.5467, device='cuda:1')
un-norm situation:
learned: map: 0.558022141456604, prec: 0.5099707245826721
11fixed: map: 0.548784077167511, prec: 0.5071857571601868
combine: map: 0.558640718460083, prec: 0.5157467722892761
norm situation:
learned: map: 0.5677940845489502, prec: 0.5330763459205627
11fixed: map: 0.5765913128852844, prec: 0.5472448468208313
combine: map: 0.5776048898696899, prec: 0.5466600060462952
udcdr == 1

Query Emb Dim:torch.Size([1883, 512]); Gallery Emb Dim:torch.Size([5857, 512])
computing unormed situation
tensor(0.6958, device='cuda:1') tensor(0.4673, device='cuda:1')
tensor(0.7023, device='cuda:1') tensor(0.4801, device='cuda:1')
tensor(0.7057, device='cuda:1') tensor(0.4811, device='cuda:1')
computing normed situation
tensor(0.7542, device='cuda:1') tensor(0.5018, device='cuda:1')
tensor(0.7692, device='cuda:1') tensor(0.5169, device='cuda:1')
tensor(0.7681, device='cuda:1') tensor(0.5148, device='cuda:1')
un-norm situation:
learned: map: 0.6957656145095825, prec: 0.46726498007774353
11fixed: map: 0.7023112773895264, prec: 0.4800637364387512
combine: map: 0.7057036757469177, prec: 0.48109927773475647
norm situation:
learned: map: 0.7542350888252258, prec: 0.501776397228241
11fixed: map: 0.7692373394966125, prec: 0.5168640613555908
combine: map: 0.7681102752685547, prec: 0.5147796273231506
Epoch Time:30m16s lr:0.0001000 mAP:0.5776 prec:0.5467

Error: /home/user/Code/DePro_SIGIR/src/algos/depro/log/DomainNet/seen-quickdraw_unseen-sketch_x_real/init.pth file not found

***Training and Validation complete***
